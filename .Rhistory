mutate(exp = round((Total_cases/c(NA,Total_cases[1:(length(Total_cases-1))]))*100,0))
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(exp = round((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))*100,0))
View(dat_exp)
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(exp = round((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))*100,0))
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(exp = (Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)])))
View(dat_exp)
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(exp = round(((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))-1)*100,0))
View(dat_exp)
shiny::runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz')
stats <- read.csv("data/corona_stats.csv")
stats %>% mutate(date == max(date))
stats %>% mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%mutate(date == max(date))
runApp('coronaviz')
county <- read.csv("data/corona_county.csv") %>%
dataCounty()  %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
filter(date == max(date)) %>%
mutate(long = case_when(county == "Carlow" ~ -6.9261098,
county == "Cavan" ~ -7.3605599,
county == "Clare" ~ -8.9811,
county == "Donegal" ~ -8.1041,
county == "Kildare" ~ -6.9144402,
county == "Kilkenny" ~ -7.2448,
county == "Laois" ~ -7.3323,
county == "Leitrim" ~ -8.0020,
county == "Longford" ~ -7.7933,
county == "Louth" ~ -6.4889,
county == "Mayo" ~ -9.4289,
county == "Meath" ~ -6.6564,
county == "Monaghan" ~ -6.9683,
county == "Offaly" ~ -7.7122,
county == "Roscommon" ~ -8.1891,
county == "Sligo" ~ -8.4761,
county == "Tipperary" ~ -8.1619,
county == "Wexford" ~ -6.4633,
county == "Kerry" ~ -9.5669,
county == "Waterford" ~ -7.1101,
county == "Westmeath" ~ -7.4653,
county == "Wicklow" ~ -6.0446,
county == "Galway" ~ -9.0568,
county == "Limerick" ~ -8.6267,
county == "Cork" ~ -8.4756,
county == "Dublin" ~ -6.2603),
lat = case_when(county == "Carlow" ~ 52.8408318,
county == "Cavan" ~ 53.9908295,
county == "Clare" ~ 52.9045,
county == "Donegal" ~ 54.6549,
county == "Kildare" ~ 53.1561089,
county == "Kilkenny" ~ 52.6541,
county == "Laois" ~ 52.9943,
county == "Leitrim" ~ 54.1247,
county == "Longford" ~ 53.7276,
county == "Louth" ~ 53.9252,
county == "Mayo" ~ 54.0153,
county == "Meath" ~ 53.6055,
county == "Monaghan" ~ 54.2492,
county == "Offaly" ~ 53.2357,
county == "Roscommon" ~ 53.6276,
county == "Sligo" ~ 54.2766,
county == "Tipperary" ~ 52.4738,
county == "Wexford" ~ 52.3369,
county == "Kerry" ~ 52.1545,
county == "Waterford" ~ 52.2593,
county == "Westmeath" ~ 53.5345,
county == "Wicklow" ~ 52.9808,
county == "Galway" ~ 53.2707,
county == "Limerick" ~ 52.6638,
county == "Cork" ~ 51.8985,
county == "Dublin" ~ 53.3498)) %>%
mutate(ncase = as.character(ncase),
ncase = ifelse(ncase == "< = 5","5",ncase)) %>%
mutate(ncase = as.numeric(ncase)) %>%
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 7) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncase)
county <- read.csv("data/corona_county.csv") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
filter(date == max(date)) %>%
mutate(long = case_when(county == "Carlow" ~ -6.9261098,
county == "Cavan" ~ -7.3605599,
county == "Clare" ~ -8.9811,
county == "Donegal" ~ -8.1041,
county == "Kildare" ~ -6.9144402,
county == "Kilkenny" ~ -7.2448,
county == "Laois" ~ -7.3323,
county == "Leitrim" ~ -8.0020,
county == "Longford" ~ -7.7933,
county == "Louth" ~ -6.4889,
county == "Mayo" ~ -9.4289,
county == "Meath" ~ -6.6564,
county == "Monaghan" ~ -6.9683,
county == "Offaly" ~ -7.7122,
county == "Roscommon" ~ -8.1891,
county == "Sligo" ~ -8.4761,
county == "Tipperary" ~ -8.1619,
county == "Wexford" ~ -6.4633,
county == "Kerry" ~ -9.5669,
county == "Waterford" ~ -7.1101,
county == "Westmeath" ~ -7.4653,
county == "Wicklow" ~ -6.0446,
county == "Galway" ~ -9.0568,
county == "Limerick" ~ -8.6267,
county == "Cork" ~ -8.4756,
county == "Dublin" ~ -6.2603),
lat = case_when(county == "Carlow" ~ 52.8408318,
county == "Cavan" ~ 53.9908295,
county == "Clare" ~ 52.9045,
county == "Donegal" ~ 54.6549,
county == "Kildare" ~ 53.1561089,
county == "Kilkenny" ~ 52.6541,
county == "Laois" ~ 52.9943,
county == "Leitrim" ~ 54.1247,
county == "Longford" ~ 53.7276,
county == "Louth" ~ 53.9252,
county == "Mayo" ~ 54.0153,
county == "Meath" ~ 53.6055,
county == "Monaghan" ~ 54.2492,
county == "Offaly" ~ 53.2357,
county == "Roscommon" ~ 53.6276,
county == "Sligo" ~ 54.2766,
county == "Tipperary" ~ 52.4738,
county == "Wexford" ~ 52.3369,
county == "Kerry" ~ 52.1545,
county == "Waterford" ~ 52.2593,
county == "Westmeath" ~ 53.5345,
county == "Wicklow" ~ 52.9808,
county == "Galway" ~ 53.2707,
county == "Limerick" ~ 52.6638,
county == "Cork" ~ 51.8985,
county == "Dublin" ~ 53.3498)) %>%
mutate(ncase = as.character(ncase),
ncase = ifelse(ncase == "< = 5","5",ncase)) %>%
mutate(ncase = as.numeric(ncase)) %>%
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 7) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncase)
county <- read.csv("data/corona_county.csv") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
filter(date == max(date)) %>%
mutate(long = case_when(county == "Carlow" ~ -6.9261098,
county == "Cavan" ~ -7.3605599,
county == "Clare" ~ -8.9811,
county == "Donegal" ~ -8.1041,
county == "Kildare" ~ -6.9144402,
county == "Kilkenny" ~ -7.2448,
county == "Laois" ~ -7.3323,
county == "Leitrim" ~ -8.0020,
county == "Longford" ~ -7.7933,
county == "Louth" ~ -6.4889,
county == "Mayo" ~ -9.4289,
county == "Meath" ~ -6.6564,
county == "Monaghan" ~ -6.9683,
county == "Offaly" ~ -7.7122,
county == "Roscommon" ~ -8.1891,
county == "Sligo" ~ -8.4761,
county == "Tipperary" ~ -8.1619,
county == "Wexford" ~ -6.4633,
county == "Kerry" ~ -9.5669,
county == "Waterford" ~ -7.1101,
county == "Westmeath" ~ -7.4653,
county == "Wicklow" ~ -6.0446,
county == "Galway" ~ -9.0568,
county == "Limerick" ~ -8.6267,
county == "Cork" ~ -8.4756,
county == "Dublin" ~ -6.2603),
lat = case_when(county == "Carlow" ~ 52.8408318,
county == "Cavan" ~ 53.9908295,
county == "Clare" ~ 52.9045,
county == "Donegal" ~ 54.6549,
county == "Kildare" ~ 53.1561089,
county == "Kilkenny" ~ 52.6541,
county == "Laois" ~ 52.9943,
county == "Leitrim" ~ 54.1247,
county == "Longford" ~ 53.7276,
county == "Louth" ~ 53.9252,
county == "Mayo" ~ 54.0153,
county == "Meath" ~ 53.6055,
county == "Monaghan" ~ 54.2492,
county == "Offaly" ~ 53.2357,
county == "Roscommon" ~ 53.6276,
county == "Sligo" ~ 54.2766,
county == "Tipperary" ~ 52.4738,
county == "Wexford" ~ 52.3369,
county == "Kerry" ~ 52.1545,
county == "Waterford" ~ 52.2593,
county == "Westmeath" ~ 53.5345,
county == "Wicklow" ~ 52.9808,
county == "Galway" ~ 53.2707,
county == "Limerick" ~ 52.6638,
county == "Cork" ~ 51.8985,
county == "Dublin" ~ 53.3498)) %>%
mutate(ncase = as.character(ncase),
ncase = ifelse(ncase == "< = 5","5",ncase)) %>%
mutate(ncase = as.numeric(ncase))
View(county)
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 7) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncase)
county <- read.csv("data/corona_county.csv") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
filter(date == max(date)) %>%
mutate(long = case_when(county == "Carlow" ~ -6.9261098,
county == "Cavan" ~ -7.3605599,
county == "Clare" ~ -8.9811,
county == "Donegal" ~ -8.1041,
county == "Kildare" ~ -6.9144402,
county == "Kilkenny" ~ -7.2448,
county == "Laois" ~ -7.3323,
county == "Leitrim" ~ -8.0020,
county == "Longford" ~ -7.7933,
county == "Louth" ~ -6.4889,
county == "Mayo" ~ -9.4289,
county == "Meath" ~ -6.6564,
county == "Monaghan" ~ -6.9683,
county == "Offaly" ~ -7.7122,
county == "Roscommon" ~ -8.1891,
county == "Sligo" ~ -8.4761,
county == "Tipperary" ~ -8.1619,
county == "Wexford" ~ -6.4633,
county == "Kerry" ~ -9.5669,
county == "Waterford" ~ -7.1101,
county == "Westmeath" ~ -7.4653,
county == "Wicklow" ~ -6.0446,
county == "Galway" ~ -9.0568,
county == "Limerick" ~ -8.6267,
county == "Cork" ~ -8.4756,
county == "Dublin" ~ -6.2603),
lat = case_when(county == "Carlow" ~ 52.8408318,
county == "Cavan" ~ 53.9908295,
county == "Clare" ~ 52.9045,
county == "Donegal" ~ 54.6549,
county == "Kildare" ~ 53.1561089,
county == "Kilkenny" ~ 52.6541,
county == "Laois" ~ 52.9943,
county == "Leitrim" ~ 54.1247,
county == "Longford" ~ 53.7276,
county == "Louth" ~ 53.9252,
county == "Mayo" ~ 54.0153,
county == "Meath" ~ 53.6055,
county == "Monaghan" ~ 54.2492,
county == "Offaly" ~ 53.2357,
county == "Roscommon" ~ 53.6276,
county == "Sligo" ~ 54.2766,
county == "Tipperary" ~ 52.4738,
county == "Wexford" ~ 52.3369,
county == "Kerry" ~ 52.1545,
county == "Waterford" ~ 52.2593,
county == "Westmeath" ~ 53.5345,
county == "Wicklow" ~ 52.9808,
county == "Galway" ~ 53.2707,
county == "Limerick" ~ 52.6638,
county == "Cork" ~ 51.8985,
county == "Dublin" ~ 53.3498)) %>%
mutate(ncases = as.character(ncase),
ncases = ifelse(ncases == "< = 5","5",ncases)) %>%
mutate(ncases = as.numeric(ncases))
View(county)
labs <- lapply(seq(nrow(county)), function(i) {
paste0( '<p>', county[i, "ncase"],' cases </p><p>')
})
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 6) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~area,
radius = ~ncases/2,
label = lapply(labs, htmltools::HTML))
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 6) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncases/2,
label = lapply(labs, htmltools::HTML))
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = ) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncase)
county %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53.5, zoom = 8) %>%
clearShapes() %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
layerId = ~county,
radius = ~ncase)
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz')
shiny::runApp('coronaviz')
?colorNumeric
pal <- colorNumeric("Reds")
runApp('coronaviz')
previewColors(colorNumeric("Blues", domain = NULL), sort(rexp(16)))
previewColors(colorNumeric("Red", domain = NULL), sort(rexp(16)))
previewColors(colorNumeric("Reds", domain = NULL), sort(rexp(16)))
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz')
runApp('coronaviz/mobileapp.R')
runApp('coronaviz')
shiny::runApp('coronaviz')
?renderUI
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(leaflet)
library(DT)
rm(list=ls())
dat <- read.csv("data/corona_island.csv")
dat <- dat %>% mutate(long = case_when(area=="east" ~ -6.2690,
area=="west" ~ -9.0650,
area=="south" ~ -8.5110),
lat = case_when(area=="east" ~ 53.3593,
area=="west" ~ 53.2760,
area=="south" ~ 51.8830))
dat_area <- dat %>% group_by(area) %>% summarise(ncases=sum(ncase,na.rm=TRUE),
ndeaths=sum(ndeath,na.rm=TRUE),
long = mean(long,na.rm=TRUE),
lat = mean(lat, na.rm=TRUE)) %>%
na.omit()
showAreaPopup <- function(t, lat, lon) {
selectedArea <- dat_area[dat_area$area == t,]
content <- as.character(tagList(
tags$h4("Number of cases:", as.integer(selectedArea$ncases)),
tags$h4("Number of deaths:", as.integer(selectedArea$nmort))
))
leafletProxy("map") %>%
addPopups(lon, lat, content, layerId = t)
}
dat_area %>%
leaflet() %>%
addTiles(
urlTemplate = "//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png",
attribution = 'Maps by <a href="http://www.mapbox.com/">Mapbox</a>'
) %>%
setView(lng = -8, lat = 53, zoom = 7) %>%
addCircleMarkers(lng= ~long,
lat= ~lat,
radius = ~ncases*3)
datatable(dat)
g= dat %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
mutate_at(vars(gender), funs(as.character(.))) %>%
bind_rows(mutate(., gender = "All")) %>%
group_by(date,gender) %>%
summarise(ncases = sum(ncase)) %>%
na.omit() %>%
ggplot(aes(x=date,y=ncases,color=gender)) + geom_line() + geom_point() + theme(legend.position="none")
ggplotly(g)
g = dat %>%
filter(country=="ireland") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
ggplot(aes(x=date,y=ccases,label=Date,label1=Total_cases,label2=New_cases)) +
geom_line() + geom_point() + geom_col(aes(x=date,y=ncases)) +
theme(legend.position="none") + labs(y="Cases")
ggplotly(g, tooltip = c("Date","Total_cases","New_cases"))
dat_compare <- dat %>% mutate(date = as.Date(date,format = "%d/%m/%Y"))
ireland = 4.83+1.882
italy=60.48
prop=ireland/italy
dat_compare$ncase[dat_compare$country=="italy"] <- round(dat_compare$ncase[dat_compare$country=="italy"]*prop,0)
dat_compare$date[dat_compare$country=="italy"] <- dat_compare$date[dat_compare$country=="italy"]+13
levels(dat_compare$country)[2] <- "italy scaled to ireland + 13 days"
g = dat_compare %>% mutate(date = as.Date(date,format = "%d/%m/%Y"))%>%
group_by(country, date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date), Country = country[1]) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
ggplot(aes(x=date,y=ccases,color=country,fill=country,label=Date,label1=Country,label2=Total_cases)) +
geom_line() + geom_point() +theme(legend.position="none") + labs(y="Cases")
ggplotly(g, tooltip = c("Country","Date","Total_cases","New_cases"))
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(Growth = round(((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))-1)*100,0))
View(dat_exp)
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(Growth = round(((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))-1)*100,0)) %>%
mutate(mean = mean(Growth,na.rm=TRUE))
View(dat_exp)
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(Growth = round(((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))-1)*100,0)) %>%
mutate(median = mean(Growth,na.rm=TRUE))
dat_exp = dat %>%
filter(country=="ireland", area!= "north") %>%
mutate(date = as.Date(date,format = "%d/%m/%Y")) %>%
group_by(date) %>%
summarise(ncases = sum(ncase), New_cases = sum(ncase), Date = min(date)) %>%
na.omit() %>%
mutate(ccases = cumsum(ncases), Total_cases= cumsum(ncases)) %>%
mutate(Growth = round(((Total_cases/c(NA,Total_cases[1:(length(Total_cases)-1)]))-1)*100,0)) %>%
mutate(median = median(Growth,na.rm=TRUE))
View(dat_exp)
runApp('coronaviz')
